<?xml version="1.0" encoding="utf-8"?>

<objects>
	<script file="gui/common/functions_global_object.js"/>
	<script file="gui/common/functions_utility.js"/>
	<script file="gui/common/timer.js"/>

	<script file="gui/lobby/lobby.js"/>

	<object type="image" style="ModernWindow" size="0 0 100% 100%" name="lobbyWindow">

		<object style="TitleText" type="text" size="50%-128 0%+4 50%+128 36">
			Multiplayer Lobby
		</object>

		<action on="Tick">
			onTick();
		</action>

		<!--  Top right 'last updated' text -->
		<object name="updateStatusText" size="100%-225 25 100%-25 45" type="text" style="RightLabelText"/>

		<!-- START Upper part of the gui containing the list of games and some details about the selected game -->
		<object size="25 50 100%-25 0%+390">
			<object name="gameInfoEmpty" size="0 0 340 100%-25" type="image" sprite="ModernDarkBoxGold" hidden="false">
				<object size="50%-110 50%-50 50%+110 50%+50" type="image" sprite="productLogo"/>
			</object>
			<object name="gameInfo" size="0 0 340 100%-25" type="image" sprite="ModernDarkBoxGold" hidden="true">
				<object name="sgMapName" size="170 0 100%-10 30" type="text" style="ModernCenteredLabelText"/>
				<object name="sgMapPreview" size="10 10 160 160"  type="image" sprite=""/>

				<object size="160 30 100%-10 31" type="image" sprite="ModernGoldLine" z="25"/>

				<!-- Number of Players -->
				<object size="160 30 100%-10 60">
					<object size="0 0 90 100%" type="image" sprite="ModernItemBackShadeLeft">
						<object size="0 0 100%-10 100%" type="text" style="ModernRightLabelText">Players:</object>
					</object>
					<object size="90 0 100% 100%" type="image" sprite="ModernItemBackShadeRight">
						<object name="sgNbPlayers" size="0 0 100% 100%" type="text" style="ModernLeftLabelText"/>
					</object>
				</object>

				<object size="160 60 100%-10 61" type="image" sprite="ModernWhiteLine" z="25"/>

				<!-- Player Names -->
				<object size="170 60 100%-10 100">
					<object name="sgPlayersNames" size="0 0 100% 100%" type="text" style="ModernCenteredLabelText"/>
				</object>

				<object size="160 100 100%-10 101" type="image" sprite="ModernWhiteLine" z="25"/>

				<!-- Map Type -->
				<object size="160 100 100% 130">
					<object size="0 0 90 100%" type="image" sprite="ModernItemBackShadeLeft">
						<object size="0 0 100%-10 100%" type="text" style="ModernRightLabelText">Map Type</object>
					</object>
					<object size="90 0 100% 100%" type="image" sprite="ModernItemBackShadeRight">
						<object name="sgMapType" size="0 0 100% 100%" type="text" style="ModernLeftLabelText"/>
					</object>
				</object>

				<object size="160 130 100%-10 131" type="image" sprite="ModernWhiteLine" z="25"/>

				<!-- Map Size -->
				<object size="160 130 100% 160">
					<object size="0 0 90 100%" type="image" sprite="ModernItemBackShadeLeft">
						<object size="0 0 100%-10 100%" type="text" style="ModernRightLabelText">Map size:</object>
					</object>
					<object size="90 0 100% 100%" type="image" sprite="ModernItemBackShadeRight">
						<object name="sgMapSize" size="0 0 100% 100%" type="text" style="ModernLeftLabelText"/>
					</object>
				</object>

				<object size="160 160 100%-10 161" type="image" sprite="ModernWhiteLine" z="25"/>

				<!-- Map Description -->
				<object type="image" sprite="ModernDarkBoxWhite" size="10 170 100%-10 100%-40">
					<object name="sgMapDescription" type="text" style="MapDescription" size="0 0 100% 100%"/>
				</object>

				<!-- Buttons -->
				<object type="button" style="StoneButton" size="100%-100 100%-30 100%-10 100%-10">
					Join
					<action on="Press">
						joinSelectedGame();
					</action>
				</object>
			</object>

			<object name="gamesBox"
				style="ModernList"
				type="olist"
				size="345 0 100% 100%">
				<action on="SelectionChange"> selectGame(this.selected);</action>
				<def id="name" heading="Name" color="0 60 0" width="180"/>
				<!--<def id="ip" heading="IP" color="0 128 128" width="170"/>-->
				<def id="mapName" heading="Map name" color="128 128 128" width="140"/>
				<def id="mapSize" heading="Map size" color="128 128 128" width="100"/>
				<def id="mapType" heading="Map Type" color="0 128 128" width="100"/>
				<def id="nPlayers" heading="Players" color="0 128 128" width="30"/>
			</object>

			<!-- START Filter panel type="image" sprite="ModernDarkBoxWhite" -->
			<object name="filterPanel" size="345 100%-20 100% 100%" hidden="true">
				<object type="text" size="0 0 75 100%" text_align="left" textcolor="white">Map size:</object>
				<object name="mapSizeFilter"
					type="dropdown"
					style="SmallStoneDropDown"
					size="75 0 150 100%">
					<action on="SelectionChange">applyFilters();</action>
				</object>

				<object type="text" size="150 0 225 100%" text_align="left" textcolor="white">Players:</object>
				<object name="playersNumberFilter"
					type="dropdown"
					style="SmallStoneDropDown"
					size="225 0 300 100%">
					<action on="SelectionChange">applyFilters();</action>
				</object>

				<object type="text" size="300 0 375 100%" text_align="left" textcolor="white">Map type:</object>
				<object name="mapTypeFilter"
					type="dropdown"
					style="SmallStoneDropDown"
					size="375 0 450 100%">
					<action on="SelectionChange">applyFilters();</action>
				</object>

				<object type="text" size="450 0 525 100%" text_align="left" textcolor="white">Hide full:</object>
				<object name="hideFullFilter"
					type="checkbox"
					checked="true"
					style="StoneCrossBox"
					size="525 3 540 100%-3">
					<action on="Press">applyFilters();</action>
				</object>

				<object type="button" style="StoneButton" size="555 0 630 100%">
					Reset
					<action on="Press">resetFilters();</action>
				</object>

			</object>
			<!-- END Filter panel -->

			<object name="gamesBar" size="0 100%-20 340 100%">
				<object type="button" style="StoneButton" size="0 0 100 20">
					Leaderboard
					<action on="Press">getGUIObjectByName("leaderboard").hidden = false;getGUIObjectByName("leaderboardFade").hidden = false;</action>
				</object>
				<object name="hostButton" type="button" style="StoneButton" size="105 0 205 20">
					Host Game
					<action on="Press">
						// Open Multiplayer connection window with host option.
						Engine.PushGuiPage("page_gamesetup_mp.xml", { multiplayerGameType: "host", name: g_Name });
					</action>
				</object>
				<object type="button" style="StoneButton" size="210 0 310 20">
					Main Menu
					<action on="Press">
						lobbyStop();
						Engine.SwitchGuiPage("page_pregame.xml");
					</action>
				</object>
				<object type="button" style="StoneButton" size="315 0 340 20">
					>>
					<action on="Press"><![CDATA[
						if(this.caption == ">>")
						{
							this.caption = "<<";
							getGUIObjectByName("filterPanel").hidden = false;
							getGUIObjectByName("gamesBox").size="345 0 100% 100%-25";
						}
						else
						{
							this.caption = ">>";
							getGUIObjectByName("filterPanel").hidden = true;
							getGUIObjectByName("gamesBox").size="345 0 100% 100%";
						}
					]]></action>
				</object>
			</object>
		</object>
		<!-- END Upper part of the gui containing the list of games and some details about the selected game -->

		<!-- START Lower part of the gui containing the chat and the list of players -->
		<object size="25 0%+395 100%-25 100%-25">
			<object name="playersBox"
				style="ModernList"
				type="olist"
				size="100%-210 0 100% 100%">
				<def id="status" heading="Status" width="60"/>
				<def id="name" heading="Name" width="50"/>
			</object>

			<object name="chatPanel" size="0 0 100%-215 100%" type="image" sprite="ModernDarkBoxGold">
				<object name="chatText" size="1 1 100%-1 100%-25" type="text" style="ChatPanel"/>
				<object name="chatInput" size="0 100%-26 100%-66 100%-1" type="input" style="StoneInput">
					<action on="Press">submitChatInput();</action>
				</object>

				<object size="100%-65 100%-26 100%-1 100%-1" type="button" style="StoneButton">
					Send
					<action on="Press">submitChatInput();</action>
				</object>
			</object>
		</object>
		<!-- END Lower part of the gui containing the chat and the list of players -->

		<!-- START Window for leaderboard stats -->
		<!-- Add a translucent black background to fade out the menu page -->
		<object hidden="true" name="leaderboardFade" type="image" z="100" sprite="modernFade"/>
		<object hidden="true" name="leaderboard" type="image" style="ModernDialog" size="50%-224 50%-160 50%+224 50%+160" z="101">
			<object style="TitleText" type="text" size="50%-128 0%-16 50%+128 16">Leaderboard</object>
			<object name="leaderboardBox"
				style="ModernList"
				type="olist"
				size="19 19 100%-19 100%-58">
				<def id="rank" heading="Rank" color="255 255 255" width="60"/>
				<def id="rating" heading="Rating" color="255 255 255" width="90"/>
				<def id="name" heading="Name" color="255 255 255" width="260"/>
			</object>
			<object type="button" style="StoneButton" size="50%+5 100%-45 50%+133 100%-17">
				Back
				<action on="Press">getGUIObjectByName("leaderboard").hidden = true;getGUIObjectByName("leaderboardFade").hidden = true;</action>
			</object>
			<object type="button" style="StoneButton" size="50%-133 100%-45 50%-5 100%-17">
				Update
				<action on="Press">Engine.SendGetBoardList();</action>
			</object>
		</object>
		<!-- END Window for leaderboard stats -->
	</object>
</objects>
